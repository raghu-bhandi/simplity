<?xml version="1.0" encoding="UTF-8"?>
<service dbAccessType="readWrite" moduleName="smtp" name="registration"
	xmlns="http://www.simplity.org/schema">
	<inputData>
		<inputFields>
			<inputField dataType="_text" name="domain" />
			<inputField dataType="_text" name="application" />
			<inputField dataType="_text" name="mailid" />
			<inputField dataType="_text" name="submitterId" />
		</inputFields>
	</inputData>
	<actions>

		<createSheet actionName="createSheetforfetch" sheetName="inregistrationrecs"
			data="domain,application,mailid;$domain,$application,$mailid" />
		<filter actionName="fetchrecords" filterRecordName="smtp.registration"
			outputSheetName="outregistrationrecs" inputSheetName="inregistrationrecs"></filter>
		<addMessage actionName="msgAlreadyregistered" messageName="smtp.alreadyregistered"
			executeIfRowsInSheet="outregistrationrecs" />
		<copyRows actionName="copyrowsforoutput01" fromSheetName="outregistrationrecs" toSheetName="outputrecs"
			executeIfRowsInSheet="outregistrationrecs" />


		<setValue actionName="apikeygen" fieldName="apikey"
			expression="apikeygen(domain)" executeIfNoRowsInSheet="outregistrationrecs"></setValue>
		<createSheet actionName="createsheetforadd" sheetName="addregistrationrecs"
			data="domain,application,mailid,submitterId,apikey;$domain,$application,$mailid,$submitterId,$apikey"
			executeIfNoRowsInSheet="outregistrationrecs" />
		<save actionName="addregistration" saveAction="add" recordName="smtp.registration" 
			inputSheetName="addregistrationrecs" executeIfNoRowsInSheet="outregistrationrecs"></save>
		<copyRows actionName="copyrowsforoutput02" fromSheetName="addregistrationrecs" toSheetName="outputrecs"
			executeIfNoRowsInSheet="outregistrationrecs" />
		<log names="outregistrationrecs"/>	

	</actions>
	<outputData>
		<outputRecords>
			<outputRecord sheetName="outputrecs" ></outputRecord>
		</outputRecords>
	</outputData>
</service>
